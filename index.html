<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>英語単語クイズ & ランキング</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Noto+Sans+JP:wght@400;700&display=swap');

        body {
            font-family: 'Montserrat', 'Noto Sans JP', sans-serif;
            background: linear-gradient(135deg, #f06d06, #ffab40);
            color: #333;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            overflow: hidden;
            position: relative;
        }

        body::before {
            content: '';
            position: absolute;
            width: 300px;
            height: 300px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 50%;
            top: -100px;
            left: -100px;
            animation: float 15s infinite ease-in-out;
        }

        body::after {
            content: '';
            position: absolute;
            width: 200px;
            height: 200px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 50%;
            bottom: -50px;
            right: -50px;
            animation: float 12s infinite reverse ease-in-out;
        }

        @keyframes float {
            0% { transform: translate(0, 0); }
            50% { transform: translate(20px, 20px); }
            100% { transform: translate(0, 0); }
        }

        .container {
            background-color: #fff;
            padding: 40px;
            border-radius: 25px;
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.2);
            text-align: center;
            width: 90%;
            max-width: 700px;
            box-sizing: border-box;
            position: relative;
            z-index: 10;
        }

        h1 {
            color: #f06d06;
            margin-bottom: 30px;
            font-size: 2.5em;
            text-shadow: 2px 2px #ffe0b2;
        }

        .score-timer {
            display: flex;
            justify-content: space-between;
            margin-bottom: 20px;
            font-size: 1.2em;
            font-weight: bold;
            color: #f06d06;
        }

        #question-area {
            margin-bottom: 30px;
            text-align: left;
        }

        #question-word {
            font-size: 1.8em;
            font-weight: bold;
            color: #ff8000;
            margin-bottom: 10px;
        }

        #sentence {
            background-color: #fff3e0;
            padding: 20px;
            border-radius: 15px;
            margin-bottom: 20px;
            font-size: 1.2em;
            line-height: 1.6;
            min-height: 80px; /* 適切な高さに調整 */
            display: flex;
            align-items: center;
            justify-content: center;
            flex-wrap: wrap; /* 長い文章に対応 */
        }

        #sentence span.blank {
            display: inline-block;
            width: 100px; /* 空欄の幅 */
            height: 1.2em; /* 空欄の高さ */
            border-bottom: 2px dashed #ff8000;
            margin: 0 5px;
            vertical-align: middle;
        }

        #hint-text {
            margin-top: 15px;
            font-style: italic;
            color: #666;
            min-height: 24px;
        }
        
        /* 新しく追加する意味表示用のスタイル */
        #answer-meaning {
            margin-top: 10px;
            font-size: 1.1em; /* 少し小さめに調整 */
            color: #007bff; /* 青系の色 */
            min-height: 30px;
            text-align: center; /* 中央寄せ */
            line-height: 1.4;
        }
        #answer-meaning strong {
            color: #ff8000; /* 単語を強調する色 */
        }
        #answer-meaning .meaning-line {
            display: block; /* 各行をブロック要素にする */
            margin-bottom: 5px; /* 行間に少しスペース */
        }


        .options {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin-bottom: 30px;
        }

        .option-button, #start-button, #next-button, #hint-button, #restart-button, #submitBtn, #reloadBtn, #firebaseStartBtn {
            background-color: #ffab40;
            color: white;
            border: none;
            padding: 15px 25px;
            border-radius: 10px;
            font-size: 1.1em;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }

        .option-button:hover, #start-button:hover, #next-button:hover, #hint-button:hover, #restart-button:hover, #submitBtn:hover, #reloadBtn:hover, #firebaseStartBtn:hover {
            background-color: #f06d06;
            transform: translateY(-3px);
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.15);
        }

        .option-button.correct {
            background-color: #66bb6a; /* 緑 */
        }

        .option-button.wrong {
            background-color: #ef5350; /* 赤 */
        }

        .button-group {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 20px;
        }

        #result-screen {
            display: none;
            text-align: center;
            margin-top: 20px; /* ランキングとの間にスペース */
        }

        #final-score {
            font-size: 3em;
            color: #f06d06;
            margin-bottom: 20px;
            text-shadow: 2px 2px #ffe0b2;
        }

        /* 名前入力とランキングのスタイル */
        .box {
            border: 1px solid #ddd;
            border-radius: 8px;
            padding: 20px; /* 広めに */
            margin: 20px 0;
            background-color: #fff; /* コンテナと同じ背景色 */
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }
        .box label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
            color: #555;
        }
        .box input {
            padding: 10px;
            width: calc(100% - 20px); /* 左右のpaddingを考慮 */
            max-width: 300px;
            border: 1px solid #ccc;
            border-radius: 8px;
            font-size: 1em;
            box-sizing: border-box; /* paddingとborderをwidthに含める */
        }
        .box button {
            margin-top: 15px;
            padding: 12px 25px;
            font-size: 1.1em;
        }
        #hello {
            display: block;
            margin-top: 10px;
            color: #666;
            font-size: 0.9em;
        }
        ol {
            padding-left: 20px;
            text-align: left;
            margin-top: 15px;
            font-size: 1.1em;
            list-style: decimal;
            color: #444;
        }
        ol li {
            padding: 8px 0;
            border-bottom: 1px dashed #eee;
        }
        ol li:last-child {
            border-bottom: none;
        }
        .ranking-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }
        .ranking-header h2 {
            margin: 0;
            color: #f06d06;
            font-size: 1.8em;
            text-shadow: 1px 1px #ffe0b2;
        }


        /* Responsive adjustments */
        @media (max-width: 768px) {
            .container {
                padding: 25px;
                margin: 20px;
            }
            h1 {
                font-size: 2em;
            }
            #question-word {
                font-size: 1.5em;
            }
            #sentence {
                font-size: 1em;
                padding: 15px;
            }
            .option-button, #start-button, #next-button, #hint-button, #restart-button, #submitBtn, #reloadBtn, #firebaseStartBtn {
                padding: 12px 20px;
                font-size: 1em;
            }
            .options {
                grid-template-columns: 1fr; /* スマホでは1列表示 */
            }
            .score-timer {
                font-size: 1em;
            }
            #answer-meaning {
                font-size: 0.9em; /* スマホではさらに小さく */
            }
            .box input {
                max-width: 100%;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>英語単語クイズ！</h1>

        <!-- 1) 名前入力とスタートボタン -->
        <div class="box" id="name-input-area">
            <label>名前（ニックネームOK）</label><br/>
            <input id="playerName" placeholder="例）いぶき太郎" />
            <div style="margin-top:8px">
                <button id="firebaseStartBtn">クイズ開始</button>
            </div>
            <small id="hello" style="display:block;margin-top:6px;color:#666"></small>
        </div>

        <div id="quiz-screen" style="display: none;">
            <div class="score-timer">
                <div>スコア: <span id="score">0</span></div>
                <div>残り時間: <span id="timer">60</span>秒</div>
            </div>

            <div id="question-area">
                <div id="question-word"></div>
                <div id="sentence"></div>
                <div id="hint-text"></div>
                <div id="answer-meaning"></div> 
            </div>

            <div class="options" id="options-container">
                <!-- 選択肢がここに動的に追加されます -->
            </div>

            <div class="button-group">
                <button id="hint-button">ヒント (和訳)</button>
                <button id="next-button" disabled>次の問題</button>
            </div>
        </div>

        <!-- 結果画面とスコア送信ボタン -->
        <div id="result-screen">
            <h2>タイムアップ！</h2>
            <p>あなたの最終スコアは...</p>
            <div id="final-score">0点</div>
            <div class="button-group">
                <button id="submitBtn" disabled>スコアを送信してランキングを見る</button>
                <button id="restart-button">もう一度プレイ</button>
            </div>
        </div>

        <!-- ランキング -->
        <div class="box">
            <div class="ranking-header">
                <h2>上位5人</h2>
                <button id="reloadBtn">更新</button>
            </div>
            <ol id="leaderboard"><li>ランキング読み込み中...</li></ol>
        </div>
    </div>

<!-- Firebase公式の読み込み（CDN） -->
<script type="module">
  // Import the functions you need from the SDKs you need
  // アプリケーションの初期化
  import { initializeApp } from "https://www.gstatic.com/firebasejs/12.5.0/firebase-app.js"; 
  // 認証機能（匿名ログイン用）
  import { getAuth, signInAnonymously, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/12.5.0/firebase-auth.js";
  // Firestoreデータベース機能（スコア保存とランキング用）
  import {
    getFirestore, collection, addDoc, query, orderBy, limit, getDocs, serverTimestamp
  } from "https://www.gstatic.com/firebasejs/12.5.0/firebase-firestore.js";
  // Analytics機能（もし使いたい場合）
  import { getAnalytics } from "https://www.gstatic.com/firebasejs/12.5.0/firebase-analytics.js";

  // あなたのウェブアプリの Firebase 設定
  const firebaseConfig = {
    apiKey: "AIzaSyC9vmY_CEa09GtLbY3pXYVXDLPhSl0AZEQ", // あなたのAPIキー
    authDomain: "test-2c6b0.firebaseapp.com",        // あなたのAuth Domain
    projectId: "test-2c6b0",                           // あなたのProject ID
    storageBucket: "test-2c6b0.firebasestorage.app", // あなたのStorage Bucket
    messagingSenderId: "830185053685",                 // あなたのMessaging Sender ID
    appId: "1:830185053685:web:7343625d183bfdf920d4bc", // あなたのApp ID
    measurementId: "G-M8JEW1SQ5R"                    // あなたのMeasurement ID (Analyticsを使う場合のみ)
  };

  // Initialize Firebase
  const app = initializeApp(firebaseConfig);
  const auth = getAuth(app); // 認証サービスを初期化
  const db   = getFirestore(app); // Firestoreサービスを初期化
  const analytics = getAnalytics(app); // Analyticsサービスを初期化 (もし使いたい場合)

  //まずは匿名ログイン
  signInAnonymously(auth).catch(console.error);
  onAuthStateChanged(auth, (user) => {
    if (user) {
      // ログインできたらランキングを1回読み込む
      loadTop5();
    }
  });

  // DOM取得 (既存の要素とFirebase関連の要素)
 const words = [
  { en: "agree", jp: "賛成する", sentence: "I totally _______ with this opinion.", sentence_jp: "私はこの意見に全面的に_______です．" },
{ en: "oppose", jp: "反対する", sentence: "strongly _______ the plan.", sentence_jp: "その計画に強固に_______" },
{ en: "advise", jp: "忠告する", sentence: "_______ him not to eat too much.", sentence_jp: "食べ過ぎないよう彼に_______" },
{ en: "tip", jp: "助言", sentence: "leave a _______ for the waiter.", sentence_jp: "図書館の利用法に関するヒント（_______）" },
{ en: "discuss", jp: "ついて話し合う", sentence: "_______ the problem with a specialist.", sentence_jp: "専門家とその問題に_______" },
{ en: "blame", jp: "責任があるとする", sentence: "_______ the car’s brakes for the accident.", sentence_jp: "その事故の原因は車のブレーキにあるとする（_______）" },
{ en: "argue", jp: "主張する", sentence: "_______ that reading aloud is important.", sentence_jp: "音読は大切だと_______" },
{ en: "claim", jp: "主張する", sentence: "_______ that a vegetarian diet is better than a meat diet.", sentence_jp: "菜食は肉食より優れていると_______" },
{ en: "complain", jp: "文句を言う", sentence: "_______ about their loud music.", sentence_jp: "彼らのうるさい音楽に_______" },
{ en: "offer", jp: "申し出る", sentence: "_______ him some coffee.", sentence_jp: "彼にコーヒーはどうですかと尋ねる（_______）" },
{ en: "suggest", jp: "示唆する", sentence: "That letter suggests that she is quite happy in her job.", sentence_jp: "その手紙は，彼女が仕事をかなり楽しんでいることを_______している．" },
{ en: "recommend", jp: "推薦する", sentence: "What would you _______?", sentence_jp: "〈レストランなどで〉何がお勧めですか（何を勧めますか）．（_______）" },
{ en: "grateful", jp: "感謝している", sentence: "I am _______ for your help.", sentence_jp: "ご助力に_______しています．" },
{ en: "apologize", jp: "謝る", sentence: "_______ to her for being late.", sentence_jp: "遅刻したことを彼女に_______" },
{ en: "excuse", jp: "言い訳", sentence: "_______ me, but do you happen to know where the station is?", sentence_jp: "_______するな．" },
{ en: "celebrate", jp: "を祝う", sentence: "_______ her 18th birthday.", sentence_jp: "彼女の18歳の誕生日_______" },
{ en: "congratulate", jp: "を祝う", sentence: "_______ her on her exam results.", sentence_jp: "試験結果について彼女_______福する" },
{ en: "admire", jp: "称賛する", sentence: "_______ him for his great performance.", sentence_jp: "すばらしい演技に対して彼を_______" },
{ en: "impress", jp: "感銘を与える", sentence: "I was deeply impressed by his speech.", sentence_jp: "彼の演説に深い_______を受けた（感銘を与えられた）．" },
{ en: "award", jp: "賞", sentence: "an _______ ceremony.", sentence_jp: "授_______式" },
{ en: "explain", jp: "説明する", sentence: "_______［×_______ about］ the rules of baseball to him.", sentence_jp: "彼に野球のルールを_______" },
{ en: "describe", jp: "説明する", sentence: "Could you _______ your lost bag?", sentence_jp: "なくしたバッグ（の特徴）を_______していただけませんか．" },
{ en: "communicate", jp: "意思の疎通をはかる", sentence: "_______ with each other in sign language.", sentence_jp: "手話でお互いに_______" },
{ en: "express", jp: "を表現する
", sentence: "_______[×Say] your opinions clearly.", sentence_jp: "はっきりと意見を言い（_______現し）なさい．" },
{ en: "promise", jp: "約束", sentence: "make a _______ to lose weight.", sentence_jp: "減量するという_______をする" },
{ en: "information", jp: "情報〈不可算〉", sentence: "various kinds of［×various］ _______.", sentence_jp: "さまざまな_______" },
{ en: "technology", jp: "技術", sentence: "science and _______.", sentence_jp: "科学_______（科学と科学技術）" },
{ en: "research", jp: "研究", sentence: "do _______ on space rockets.", sentence_jp: "宇宙ロケットに関する_______を行う" },
{ en: "material", jp: "材料", sentence: "give _______ support.", sentence_jp: "レポートの_______を集める" },
{ en: "artificial", jp: "人工的な", sentence: "_______ intelligence (AI).", sentence_jp: "_______知能" },
{ en: "electric", jp: "電気の", sentence: "an _______ car.", sentence_jp: "_______自動車" },
{ en: "invent", jp: "発明する", sentence: "_______ a speaking robot.", sentence_jp: "会話のできるロボットを_______" },
{ en: "discover", jp: "発見する", sentence: "_______ a human mummy.", sentence_jp: "人間のミイラを_______" },
{ en: "develop", jp: "発達する", sentence: "_______ into a big city.", sentence_jp: "大都市に発展する（_______）" },
{ en: "skill", jp: "技術", sentence: "improve my tennis skills.", sentence_jp: "テニスの_______を高める" },
{ en: "ability", jp: "能力", sentence: "improve my _______ to speak English[×of speaking English].", sentence_jp: "英語を話す力を伸ばす（_______）" },
{ en: "talent", jp: "才能", sentence: "show my musical _______.", sentence_jp: "音楽の_______を発揮する" },
{ en: "effort", jp: "努力", sentence: "make an _______ to be on time.", sentence_jp: "時間に間に合うように_______する" },
{ en: "practice", jp: "練習", sentence: "We have _______ on Saturday.", sentence_jp: "土曜日に_______がある．" },
{ en: "achieve", jp: "達成する", sentence: "_______ his goal of becoming a vet.", sentence_jp: "獣医になるという目標を_______" },
{ en: "manage", jp: "何とかして～する", sentence: "_______ my time effectively.", sentence_jp: "_______か終電に乗ることができた．" },
{ en: "improve", jp: "改善する", sentence: "_______ my cooking skills.", sentence_jp: "私の料理の腕を上達させる（_______）" },
{ en: "produce", jp: "生産する", sentence: "_______ rice and vegetables.", sentence_jp: "米と野菜を_______" },
{ en: "create", jp: "創造する", sentence: "_______ a website.", sentence_jp: "ホームページを創る（_______）" },
{ en: "establish", jp: "確立する", sentence: "_______ a close friendship with him.", sentence_jp: "彼と親密な友情を築く（_______）" },
{ en: "form", jp: "形成する", sentence: "_______ a rock band.", sentence_jp: "ロックバンドを_______" },
{ en: "save", jp: "を省く", sentence: "_______ some money every month.", sentence_jp: "これによって多くの手間が省ける．（_______）" },
{ en: "medicine", jp: "薬", sentence: "take[×drink] the _______ twice a day.", sentence_jp: "1日に2 回その_______を飲む" },
{ en: "patient", jp: "患者", sentence: "The _______ is getting better.", sentence_jp: "その_______は快方に向かっている．" },
{ en: "condition", jp: "状態", sentence: "My body is in good _______.", sentence_jp: "私の体は調子がよい．（_______）" },
{ en: "medical", jp: "医療の", sentence: "_______ expenses.", sentence_jp: "_______費" },
{ en: "stress", jp: "ストレス", sentence: "have a lot of _______.", sentence_jp: "_______が多い" },
{ en: "suffer", jp: "苦しむ", sentence: "I am suffering from jet lag.", sentence_jp: "時差ぼけに_______んでいる．" },
{ en: "exercise", jp: "運動", sentence: "get light _______.", sentence_jp: "軽い_______をする" },
{ en: "breathe", jp: "呼吸する", sentence: "_______ deeply.", sentence_jp: "深_______" },
{ en: "thirsty", jp: "のどが渇いた", sentence: "I'm really _______.", sentence_jp: "本当に_______．" },
{ en: "physical", jp: "身体的な", sentence: "_______ health.", sentence_jp: "体の健康（_______）" },
{ en: "fever", jp: "熱", sentence: "I have a _______.", sentence_jp: "_______がある．" },
{ en: "strength", jp: "体力", sentence: "build up my physical _______.", sentence_jp: "_______をつける" },
{ en: "tear", jp: "涙〈可算〉", sentence: "_______ up the letter from him.", sentence_jp: "私は感動して泣いた．（_______）" },
{ en: "taste", jp: "の味がする", sentence: "_______ the soup.", sentence_jp: "このリンゴは甘い（味がする）．（_______）" },
{ en: "rule", jp: "規則", sentence: "_______ the country.", sentence_jp: "それは_______違反だ．" },
{ en: "role", jp: "役割", sentence: "play an important _______ in society.", sentence_jp: "社会で重要な_______を果たす" },
{ en: "habit", jp: "習慣", sentence: "have a _______ of making excuses.", sentence_jp: "言い訳をする癖がある（_______）" },
{ en: "custom", jp: "習慣", sentence: "Different countries have different customs.", sentence_jp: "_______は国によって違う（異なる国は異なる習慣をもつ）．" },
{ en: "tradition", jp: "伝統", sentence: "Japanese traditions.", sentence_jp: "日本の_______" },
{ en: "society", jp: "社会〈不可算〉", sentence: "women’s status in _______.", sentence_jp: "_______での女性の地位" },
{ en: "law", jp: "法律", sentence: "Parking here is against the _______.", sentence_jp: "ここでの駐車は_______違反だ．" },
{ en: "ancestor", jp: "祖先", sentence: "My ancestors were French.", sentence_jp: "私の_______はフランス人だった．" },
{ en: "population", jp: "人口", sentence: "The _______ of Tokyo is larger[×more] than that of Osaka.", sentence_jp: "東京の_______は大阪の人口より多い．" },
{ en: "native", jp: "母国の", sentence: "his _______ language.", sentence_jp: "彼の母（国）語（_______）" },
{ en: "abroad", jp: "海外へ", sentence: "find a job _______.", sentence_jp: "_______で仕事を見つける" },
{ en: "local", jp: "その土地の", sentence: "a _______ bank.", sentence_jp: "地元の銀行（_______）" },
{ en: "survey", jp: "調査〈可算〉", sentence: "according to a recent _______.", sentence_jp: "最近の_______によると" },
{ en: "value", jp: "価値", sentence: "the _______ of the painting.", sentence_jp: "その絵の_______" },
{ en: "treasure", jp: "財宝", sentence: "a national _______.", sentence_jp: "国宝（_______）" },
{ en: "fashion", jp: "流行", sentence: "follow the latest _______.", sentence_jp: "最新の_______を追う" },
{ en: "public", jp: "大衆", sentence: "the general _______.", sentence_jp: "一般_______" },
{ en: "evidence", jp: "証拠〈不可算〉", sentence: "There is no _______ to support his story.", sentence_jp: "彼の話を裏づける_______はない．" },
{ en: "vote", jp: "投票", sentence: "receive 45% of the _______.", sentence_jp: "_______数の45％を獲得する" },
{ en: "government", jp: "政府", sentence: "the Japanese _______.", sentence_jp: "日本_______" },
{ en: "nation", jp: "国家", sentence: "the most powerful _______ in the world.", sentence_jp: "世界で一番力のある国（_______）" },
{ en: "capital", jp: "首都", sentence: "What is the _______ of Canada?", sentence_jp: "カナダの_______はどこですか．" },
{ en: "state", jp: "州", sentence: "his _______ of mind.", sentence_jp: "アメリカ合衆国（_______）" },
{ en: "political", jp: "政治的な", sentence: "the _______ situation in Russia.", sentence_jp: "ロシアの_______情勢" },
{ en: "price", jp: "価格", sentence: "pay a very high _______ for the painting.", sentence_jp: "その絵に非常に高額（の_______）を支払う" },
{ en: "sum", jp: "金額", sentence: "pay a large _______ for antiques.", sentence_jp: "骨とう品に大金を使う（_______）" },
{ en: "budget", jp: "予算", sentence: "our _______ for this trip.", sentence_jp: "今回の旅の_______" },
{ en: "fee", jp: "料金", sentence: "pay a cancellation _______.", sentence_jp: "キャンセル料を払う（_______）" },
{ en: "fare", jp: "運賃", sentence: "Taxi fares are low in Singapore.", sentence_jp: "シンガポールのタクシー料金（_______）は安い．" },
{ en: "bill", jp: "勘定", sentence: "May we have the _______?", sentence_jp: "お会計お願いします．（_______）" },
{ en: "trade", jp: "貿易", sentence: "Japan’s _______ with the U.S.", sentence_jp: "日本の対米_______" },
{ en: "wealth", jp: "富", sentence: "achieve _______ and power.", sentence_jp: "_______と権力を手にする" },
{ en: "economy", jp: "経済", sentence: "boost the Japanese _______.", sentence_jp: "日本_______を活性化する" },
{ en: "cost", jp: "を要する", sentence: "The suit _______[×was] me 500 dollars.", sentence_jp: "そのスーツは500 ドルした（かかった）．（_______）" },
{ en: "company", jp: "会社", sentence: "work for a big _______.", sentence_jp: "大きな_______で働く" },
{ en: "task", jp: "仕事〈可算〉", sentence: "accomplish a difficult _______.", sentence_jp: "困難な_______を成し遂げる" },
{ en: "earn", jp: "を稼ぐ", sentence: "_______ money to pay my school fees.", sentence_jp: "学費を払う金_______" },
{ en: "hurt", jp: "痛む", sentence: "He _______ his knee while (he was) playing football.", sentence_jp: "腰がとても痛い．（_______）" },
{ en: "injure", jp: "痛める", sentence: "_______ my back.", sentence_jp: "腰を_______" },
{ en: "damage", jp: "損害を与える", sentence: "seriously _______ the environment.", sentence_jp: "環境に深刻な被害を与える（_______）" },
{ en: "destroy", jp: "破壊する", sentence: "_______ all weapons.", sentence_jp: "すべての武器を_______" },
{ en: "ruin", jp: "台無しにする", sentence: "You ruined my plan.", sentence_jp: "君のせいで計画が台無しだよ（君は私の計画を_______した）．" },
{ en: "danger", jp: "危険", sentence: "Tigers are in _______ of extinction.", sentence_jp: "トラが絶滅の危機にある．（_______）" },
{ en: "neighbor", jp: "近所の人", sentence: "chat with a _______.", sentence_jp: "_______と話す" },
{ en: "audience", jp: "聴衆", sentence: "draw a large _______.", sentence_jp: "大観衆を集める（_______）" },
{ en: "crowd", jp: "群衆", sentence: "A _______ rushed into the hall.", sentence_jp: "_______が会場になだれ込んだ．" },
{ en: "author", jp: "著者", sentence: "the _______ of War and Peace.", sentence_jp: "『戦争と平和』の_______" },
{ en: "staff", jp: "職員", sentence: "Most of the _______ is［〈英〉are］ from Australia.", sentence_jp: "_______の大半はオーストラリア出身です．" },
{ en: "clerk", jp: "〈米〉店員", sentence: "a bank _______.", sentence_jp: "あのデパートの店員（_______）" },
{ en: "customer", jp: "客", sentence: "The restaurant was crowded with customers from abroad.", sentence_jp: "そのレストランは外国人_______で混雑していた．" },
{ en: "passenger", jp: "乗客", sentence: "There were a lot of passengers on the train.", sentence_jp: "列車には多くの_______が乗っていた．" },
{ en: "elderly", jp: "年配の", sentence: "give up my seat to _______ people.", sentence_jp: "お年寄り（_______人）に席を譲る" },
{ en: "female", jp: "女性の", sentence: "_______ workers.", sentence_jp: "_______労働者" },
{ en: "head", jp: "向かう", sentence: "_______ for the beach.", sentence_jp: "海辺に_______" },
{ en: "follow", jp: "の後について行く", sentence: "_______ his advice.", sentence_jp: "誰かが私をつけていた．（_______）" },
{ en: "wander", jp: "歩き回る", sentence: "_______ about the town.", sentence_jp: "街をぶらぶら_______" },
{ en: "travel", jp: "旅行する", sentence: "_______ around the world.", sentence_jp: "世界中を旅する（_______）" },
{ en: "pass", jp: "通り過ぎる", sentence: "_______ the post office.", sentence_jp: "郵便局（の前）を_______" },
{ en: "likely", jp: "しそうする", sentence: "Things are _______ to improve.", sentence_jp: "事態はよくなりそうだ．（_______）" },
{ en: "natural", jp: "当然の", sentence: "It is only _______ that you cannot catch words you do not know.", sentence_jp: "知らない単語を聞き取れないのはごく_______ことだ．" },
{ en: "certain", jp: "確かな", sentence: "He is _______ to become a star player.", sentence_jp: "彼はきっとスター選手になるよ．（_______）" },
{ en: "probably", jp: "おそらく", sentence: "The repairs will _______ take a.", sentence_jp: "修理は_______1か月はかかるだろう．" },
{ en: "face", jp: "直面する", sentence: "lose _______.", sentence_jp: "私たちは危機に_______している．" },
{ en: "avoid", jp: "避ける", sentence: "_______ making eye contact with monkeys.", sentence_jp: "サルとは目を合わせないようにしなさい（サルと目を合わせることを_______ろ）．" },
{ en: "solve", jp: "解決する", sentence: "_______ the math problem.", sentence_jp: "その数学の問題を解く（_______）" },
{ en: "trouble", jp: "問題", sentence: "have _______ sleeping.", sentence_jp: "寝つけない（眠るのに苦労する）（_______）" },
{ en: "issue", jp: "問題", sentence: "an international _______.", sentence_jp: "国際_______" },
{ en: "cheer", jp: "声援を送る", sentence: "_______ all the players on.", sentence_jp: "すべての選手たちに_______" },
{ en: "encourage", jp: "に促す", sentence: "_______ people to bike to work.", sentence_jp: "人々に自転車通勤するよう促す（_______）" },
{ en: "support", jp: "支持する", sentence: "firmly _______ her.", sentence_jp: "強く彼女を_______" },
{ en: "prevent", jp: "を妨げる", sentence: "_______ the flu.", sentence_jp: "大雪のため外出できなかった（私たちが外出するの_______げた）．" },
{ en: "deny", jp: "否定する", sentence: "_______ that he is a great scientist.", sentence_jp: "彼が偉大な科学者であることを_______" },
{ en: "enable", jp: "に［が］可能にする", sentence: "The internet has enabled us to receive information right away.", sentence_jp: "インターネットのおかげで情報をすぐに得られるようになった（私たちが情報をすぐに得ることを可能にした）．（_______）" },
{ en: "succeed", jp: "成功する", sentence: "_______ in landing on the moon.", sentence_jp: "月面着陸に_______" },
{ en: "miss", jp: "逃す", sentence: "_______ the last train.", sentence_jp: "終電を_______" },
{ en: "fail", jp: "失敗する", sentence: "_______ in business.", sentence_jp: "商売で_______" },
{ en: "mistake", jp: "間違い", sentence: "_______ him for his twin brother.", sentence_jp: "文法ミスをする（_______）" },
{ en: "check", jp: "調べる", sentence: "_______ the brakes.", sentence_jp: "そのブレーキを_______" },
{ en: "hide", jp: "隠す", sentence: "_______ the comic under the pillow.", sentence_jp: "枕の下に漫画を_______" },
{ en: "draw", jp: "を描く", sentence: "_______ her portrait.", sentence_jp: "彼女の似顔絵_______" },
{ en: "join", jp: "に加わる", sentence: "_______ the Me Too movement.", sentence_jp: "Me Too運動に参加する（_______）" },
{ en: "throw", jp: "投げる", sentence: "_______ me a rope.", sentence_jp: "ロープを_______てくれ．" },
{ en: "operate", jp: "を操作する", sentence: "_______ five machines at once.", sentence_jp: "1度に5台の機械_______" },
{ en: "repair", jp: "修理する", sentence: "_______ a bicycle.", sentence_jp: "自転車を_______" },
{ en: "sew", jp: "縫う", sentence: "_______ a button on.", sentence_jp: "彼女は自分の服をすべて自分で縫っている．（_______）" },
{ en: "raise", jp: "上げる", sentence: "_______ your hand.", sentence_jp: "手を_______て．" },
{ en: "serve", jp: "を出す", sentence: "_______ wine to the guests.", sentence_jp: "客にワイン_______" },
{ en: "pour", jp: "注ぐ", sentence: "_______ tea for all of the guests.", sentence_jp: "客みんなにお茶を_______" },
{ en: "spill", jp: "こぼす", sentence: "_______ coffee all over my laptop.", sentence_jp: "コーヒーをノートパソコンの上に_______" },
{ en: "pretend", jp: "ふりをする", sentence: "_______ to be sleeping.", sentence_jp: "寝ている_______" },
{ en: "behave", jp: "ふるまう", sentence: "tell him to _______ himself.", sentence_jp: "彼の授業中の態度は悪い（彼は授業中，行儀悪く_______）．" },
{ en: "bear", jp: "耐える", sentence: "cannot _______ the noise.", sentence_jp: "騒音に_______られない" },
{ en: "explore", jp: "探検する", sentence: "_______ the surface of Mars.", sentence_jp: "火星の地表を探査する（_______）" },
{ en: "happen", jp: "起こる", sentence: "What happened to her?", sentence_jp: "彼女に何が_______ったの．" },
{ en: "appear", jp: "現れる", sentence: "The singer appeared on the stage.", sentence_jp: "その歌手がステージに_______た．" },
{ en: "remain", jp: "のままでいる", sentence: "The cause of the accident remains unknown.", sentence_jp: "その事故の原因はいまだに知られていない（知られていないままだ）．（_______）" },
{ en: "survive", jp: "生き残る", sentence: "eat grass in order to _______.", sentence_jp: "_______延びるため草を食べる" },
{ en: "belong", jp: "所属している", sentence: "Sam belongs[×is belonging] to the Sales Department.", sentence_jp: "サムは営業部に_______．" },
{ en: "represent", jp: "代表する", sentence: "_______ Japan at the World Cup.", sentence_jp: "ワールドカップ日本_______となる" },
{ en: "base", jp: "の基礎を置く", sentence: "I work in many places, but my _______ is here.", sentence_jp: "この小説は事実に基づいている．（_______）" },
{ en: "include", jp: "含む", sentence: "The price includes postage.（≒ Postage is included in the price.）.", sentence_jp: "価格には送料が含まれています（送料を_______）．" },
{ en: "contain", jp: "含む", sentence: "I cannot _______ my anger.", sentence_jp: "このスープにはさまざまな薬草が入っている（さまざまな薬草を含んでいる）．（_______）" },
{ en: "own", jp: "自分自身の", sentence: "with my _______ eyes.", sentence_jp: "私自身の目で（_______）" },
{ en: "share", jp: "共有する", sentence: "_______ a table with a stranger.", sentence_jp: "知らない人と相席（席を_______）する" },
{ en: "collect", jp: "を集める", sentence: "_______ teddy bears.", sentence_jp: "クマのぬいぐるみ_______" },
{ en: "gather", jp: "集める", sentence: "_______ information.", sentence_jp: "情報を_______" },
{ en: "history", jp: "歴史", sentence: "the best soccer player in _______.", sentence_jp: "史上最高のサッカー選手（_______）" },
{ en: "subject", jp: "科目", sentence: "a required _______.", sentence_jp: "必須_______" },
{ en: "education", jp: "教育", sentence: "receive a good _______.", sentence_jp: "よい_______を受ける" },
{ en: "knowledge", jp: "知識", sentence: "have a wide range of _______ of cinema.", sentence_jp: "映画に関する幅広い_______を持っている" },
{ en: "uniform", jp: "制服", sentence: "wear a school _______.", sentence_jp: "学校の_______を着ている" },
{ en: "grade", jp: "学年", sentence: "She is in the eighth _______. （＝She is an eighth grader.）.", sentence_jp: "彼女は8年生（中学2年生）だ．（_______）" },
{ en: "senior", jp: "最上級生", sentence: "a college _______.", sentence_jp: "大学4年生（_______）" },
{ en: "graduate", jp: "卒業する", sentence: "_______ from high school.", sentence_jp: "高校を_______" },
{ en: "decide", jp: "を決定する", sentence: "_______ to live on my own.", sentence_jp: "一人で暮らすこと_______心する" },
{ en: "judge", jp: "判断する", sentence: "_______ someone by their appearance.", sentence_jp: "人を外見で_______" },
{ en: "quit", jp: "やめる", sentence: "_______ my job.", sentence_jp: "仕事を_______" },
{ en: "retire", jp: "引退する", sentence: "_______ from the company.", sentence_jp: "会社を（定年で）退職する（_______）" },
{ en: "review", jp: "再検討", sentence: "a _______ of the tax system.", sentence_jp: "税制の見直し（_______）" },
{ en: "choose", jp: "選ぶ", sentence: "_______ what to wear to school.", sentence_jp: "学校へ着ていく服を_______" },
{ en: "imagine", jp: "想像する", sentence: "_______ life without electricity.", sentence_jp: "電気のない生活を_______してごらん．" },
{ en: "guess", jp: "推測する", sentence: "_______ what is in this bag.", sentence_jp: "この袋に何が入っているかを当ててごらん．（_______）" },
{ en: "expect", jp: "予期する", sentence: "Don’t _______ too much of[from] him.", sentence_jp: "台風が来るらしい（来ることを_______している）．" },
{ en: "predict", jp: "予測する", sentence: "_______ when cherry blossoms will start to flower.", sentence_jp: "桜の開花時期を_______" },
{ en: "remember", jp: "を覚えている", sentence: "I _______ meeting her here[that I met her here].", sentence_jp: "彼女にここで会ったこと_______えています．" },
{ en: "remind", jp: "に思い出させる", sentence: "_______ him not to be late.", sentence_jp: "この歌は彼のことを私_______．" },
{ en: "realize", jp: "理解する", sentence: "Jim realized[×noticed] that he did not love her any more.", sentence_jp: "ジムはもう彼女のことを愛していないことに気づいた．（_______）" },
{ en: "appreciate", jp: "理解する", sentence: "_______ the importance of discussion.", sentence_jp: "話し合いの重要性を_______" },
{ en: "accept", jp: "受け入れる", sentence: "_______ other people’s opinions.", sentence_jp: "他人の意見を_______" },
{ en: "consider", jp: "よく考える", sentence: "_______ all the possibilities.", sentence_jp: "すべての可能性を考える（_______）" },
{ en: "mind", jp: "気にする", sentence: "Do you _______ if I open the window?", sentence_jp: "窓を開けてもいいですか（窓を開けるのを_______しますか）．" },
{ en: "wonder", jp: "なと思う", sentence: "I _______[×think] where he has gone.", sentence_jp: "彼はどこに行ってしまったのだろうか．（_______）" },
{ en: "seem", jp: "のように思われる", sentence: "It seems that he knows what happened.", sentence_jp: "彼は起きたことを知っているようだ．（_______）" },
{ en: "compare", jp: "を比較する", sentence: "_______ city life with country life.", sentence_jp: "都会の生活を田舎の生活と比較する（_______）" },
{ en: "concentrate", jp: "集中する", sentence: "_______ on my studies.", sentence_jp: "勉強に_______" },
{ en: "focus", jp: "焦点を当てる", sentence: "become the _______ of media attention.", sentence_jp: "この本はフランス文化に_______を当てている．" },
{ en: "allow", jp: "許可する", sentence: "Please _______ me to introduce myself.", sentence_jp: "自己紹介をさせて（自己紹介するのを_______して）ください．" },
{ en: "admit", jp: "認める", sentence: "Tom admitted that he had been mistaken.", sentence_jp: "トムは自分が間違っていたことを_______た．" },
{ en: "ground", jp: "地面", sentence: "deep in the _______.", sentence_jp: "地中深くに（_______）" },
{ en: "pollution", jp: "汚染", sentence: "prevent marine _______.", sentence_jp: "海洋_______を食い止める" },
{ en: "sight", jp: "光景", sentence: "Snow is a rare _______ in this area.", sentence_jp: "雪はこの地域では珍しい_______です．" },
{ en: "view", jp: "眺め", sentence: "enjoy a night _______ of Kobe.", sentence_jp: "神戸の夜景（夜の景色）を楽しむ（_______）" },
{ en: "landscape", jp: "風景", sentence: "the beautiful _______ of Scotland.", sentence_jp: "スコットランドの美しい_______" },
{ en: "nature", jp: "自然", sentence: "preserve _______.", sentence_jp: "_______を守る" },
{ en: "seed", jp: "種", sentence: "He is top _______ in this tournament.", sentence_jp: "ひまわりの_______" },
{ en: "plant", jp: "植物", sentence: "water a _______.", sentence_jp: "_______に水をやる" },
{ en: "bloom", jp: "咲く", sentence: "The cherry trees are in full _______.", sentence_jp: "野原には一面花が咲いていた．（_______）" },
{ en: "harvest", jp: "収穫", sentence: "the rice _______ this year.", sentence_jp: "今年の米の_______" },
{ en: "insect", jp: "昆虫", sentence: "the chirping of insects.", sentence_jp: "（チーッチーッという）虫の音（_______）" },
{ en: "earthquake", jp: "地震", sentence: "There was an _______ last week.", sentence_jp: "先週，_______が起きた．" },
{ en: "temperature", jp: "温度", sentence: "The _______ reached 40 degrees.", sentence_jp: "気温が40度まで上がった．（_______）" },
{ en: "degree", jp: "度", sentence: "speak French to some _______.", sentence_jp: "ゼロ_______で凍る" },
{ en: "flood", jp: "洪水〈可算〉", sentence: "The _______ washed the bridge away.", sentence_jp: "_______で橋が流された．" },
{ en: "freeze", jp: "凍る", sentence: "_______ bananas in the freezer.", sentence_jp: "池が一面凍った．（_______）" },
{ en: "reflect", jp: "反射する", sentence: "_______ the sunlight.", sentence_jp: "日光を_______" },
{ en: "polite", jp: "礼儀正しい", sentence: "a _______ young man.", sentence_jp: "_______若い男性" },
{ en: "rude", jp: "無礼な", sentence: "It is _______ to ask women their age.", sentence_jp: "女性に年齢を尋ねるのは_______です．" },
{ en: "lonely", jp: "孤独な", sentence: "_______ old people.", sentence_jp: "_______老人たち" },
{ en: "lazy", jp: "怠惰な", sentence: "He is _______ at work.", sentence_jp: "彼は仕事をいい加減にやる．（_______）" },
{ en: "strict", jp: "厳しい", sentence: "a _______ rule.", sentence_jp: "_______規則" },
{ en: "ugly", jp: "醜い", sentence: "The _______ Duckling.", sentence_jp: "『_______アヒルの子』（Andersen の童話）" },
{ en: "intelligent", jp: "知的な", sentence: "a highly _______ woman.", sentence_jp: "きわめて聡明な女性（_______）" },
{ en: "silly", jp: "ばかな", sentence: "Don’t be _______!", sentence_jp: "_______ことを言う［する］な！" },
{ en: "nervous", jp: "あがって", sentence: "get _______ during the exam.", sentence_jp: "試験中に_______る" },
{ en: "awake", jp: "目を覚まして", sentence: "The noise kept me _______ all night.", sentence_jp: "騒音で一晩中眠れなかった（_______覚ました状態にされていた）．" },
{ en: "alone", jp: "1", sentence: "She lives _______.", sentence_jp: "彼女は一人暮らしだ．（_______）" },
{ en: "attitude", jp: "態度", sentence: "have a positive _______ toward life.", sentence_jp: "人生に対して前向きな姿勢でいる（_______）" },
{ en: "character", jp: "性格", sentence: "Printed books have _______.", sentence_jp: "活字の本には味（特徴）がある．（_______）" },
{ en: "characteristic", jp: "特徴〈可算〉", sentence: "his _______ writing style.", sentence_jp: "大都会の_______の1つ" },
{ en: "feature", jp: "特徴", sentence: "Low rainfall is a _______ of deserts.", sentence_jp: "少ない降水量は砂漠の_______の1つだ．" },
{ en: "detail", jp: "詳細", sentence: "check the details of the report.", sentence_jp: "その報告書の_______を確認する" },
{ en: "advantage", jp: "利点", sentence: "There are advantages and disadvantages[×merits and demerits] to self-driving cars.", sentence_jp: "自動運転の車にはメリットとデメリットがある．（_______）" },
{ en: "fault", jp: "欠点", sentence: "That is my _______.", sentence_jp: "夫の_______について文句を言う" },
{ en: "quality", jp: "質〈不可算〉", sentence: "improve the _______ of life.", sentence_jp: "生活の質を向上させる（_______）" },
{ en: "correct", jp: "正確な", sentence: "Let’s see if our answers are _______.", sentence_jp: "答えが正しいかどうか見てみよう．（_______）" },
{ en: "ideal", jp: "理想的な", sentence: "an _______ place for camping.", sentence_jp: "キャンプにはうってつけの場所（_______）" },
{ en: "fair", jp: "公正な", sentence: "It’s not _______!", sentence_jp: "それは不公平だ．（_______）" },
{ en: "appropriate", jp: "適切な", sentence: "clothes _______ for a job interview.", sentence_jp: "仕事の面接に_______服" },
{ en: "famous", jp: "有名な", sentence: "Kyoto is _______ for its temples.", sentence_jp: "京都は寺で_______だ．" },
{ en: "elementary", jp: "初歩的な", sentence: "when I was in _______ school.", sentence_jp: "小学生（小学校に在学中）のとき（_______）" },
{ en: "major", jp: "主要な", sentence: "a _______ cause of global warming.", sentence_jp: "地球温暖化の主な原因（_______）" },
{ en: "matter", jp: "重要である", sentence: "It does not _______ whether he succeeds[×will succeed] or not.", sentence_jp: "彼が成功するかどうかは_______ではない．" },
{ en: "bright", jp: "明るい", sentence: "The moon is _______ tonight.", sentence_jp: "今夜は月が_______．" },
{ en: "brilliant", jp: "輝いている", sentence: "swim in the _______ sunshine.", sentence_jp: "まばゆい太陽光の下で泳ぐ（_______）" },
{ en: "lively", jp: "生き生きとした", sentence: "have a _______ conversation.", sentence_jp: "_______会話をする" },
{ en: "comfortable", jp: "快適な", sentence: "a _______ bed.", sentence_jp: "_______ベッド" },
{ en: "pleasant", jp: "楽しい", sentence: "I find it _______[×feel _______] to talk with her.", sentence_jp: "彼女と話すのは_______と感じる．" },
{ en: "convenient", jp: "都合がよい", sentence: "Call me when it is _______ for you[×when you are _______].", sentence_jp: "_______のよいときに電話してください．" },
{ en: "false", jp: "誤った", sentence: "_______ information.", sentence_jp: "_______情報" },
{ en: "terrible", jp: "ひどい", sentence: "I have a _______ sense of direction.", sentence_jp: "私は方向音痴（_______方向感覚）だ．" },
{ en: "awful", jp: "ひどい", sentence: "an _______ smell of cat urine.", sentence_jp: "ネコの尿の_______臭い" },
{ en: "thin", jp: "薄い", sentence: "a _______ jacket.", sentence_jp: "_______上着" },
{ en: "tight", jp: "引き締まった", sentence: "_______ jeans.", sentence_jp: "きついジーンズ（_______）" },
{ en: "loose", jp: "ゆるい", sentence: "wear _______ clothes.", sentence_jp: "ダボッとした（_______）服を着ている" },
{ en: "raw", jp: "生の", sentence: "_______ fish.", sentence_jp: "生魚（_______）" },
{ en: "empty", jp: "空の", sentence: "an _______ bottle.", sentence_jp: "空瓶（_______）" },
{ en: "smooth", jp: "滑らかな", sentence: "This soap makes your skin very _______.", sentence_jp: "この石けんでお肌はツルツル（とても_______か）になります．" },
{ en: "direct", jp: "直接的な", sentence: "a _______ flight to Paris.", sentence_jp: "パリへの直行便（_______）" },
{ en: "familiar", jp: "知られた", sentence: "Shakespeare is _______ to people all over the world.", sentence_jp: "シェイクスピアは世界中の人々に_______れている．" },
{ en: "similar", jp: "似た", sentence: "She is _______ to her mother in appearance.", sentence_jp: "彼女は見た目が母親に似ている．（_______）" },
{ en: "differ", jp: "異なる", sentence: "His tastes _______ from mine.", sentence_jp: "彼の趣味は私の（趣味）と_______．" },
{ en: "vary", jp: "さまざまする", sentence: "The way people greet each other varies from country to country.", sentence_jp: "挨拶の仕方は国により_______だ．" },
{ en: "specific", jp: "特定の", sentence: "a _______ age group.", sentence_jp: "ある_______年齢のグループ" },
{ en: "common", jp: "普及した", sentence: "E-books are becoming _______.", sentence_jp: "電子書籍は_______しつつある．" },
{ en: "unusual", jp: "珍しい", sentence: "These days, it is not _______ for men to wear makeup.", sentence_jp: "最近は，男性が化粧するのは_______くない．" },
{ en: "add", jp: "加える", sentence: "_______ some milk to the coffee.", sentence_jp: "コーヒーにミルクを_______" },
{ en: "increase", jp: "増える", sentence: "_______ by 30 percent.", sentence_jp: "30％_______" },
{ en: "reduce", jp: "減らす", sentence: "_______ the amount of garbage.", sentence_jp: "生ゴミ（の量）を_______" },
{ en: "divide", jp: "分割する", sentence: "_______ the stew into small portions.", sentence_jp: "シチューを小分けにする（_______）" },
{ en: "count", jp: "数える", sentence: "_______ the money.", sentence_jp: "お金を_______" },
{ en: "weigh", jp: "の重さがある", sentence: "_______ 40 kilograms.", sentence_jp: "40キロ_______さだ" },
{ en: "quarter", jp: "4分の1", sentence: "a _______ to ten.", sentence_jp: "10時15分前（9：45）（_______）" },
{ en: "lot", jp: "多くの～", sentence: "a _______ of dolphins.", sentence_jp: "_______のイルカ" },
{ en: "pile", jp: "積み重ね", sentence: "a _______ of ironed shirts.", sentence_jp: "アイロンをかけたシャツの山（_______）" },
{ en: "rate", jp: "割合", sentence: "the declining birth _______.", sentence_jp: "少子化（下がりつつある出生率）（_______）" },
{ en: "figure", jp: "数字", sentence: "a political _______.", sentence_jp: "_______の一覧を暗記する" },
{ en: "lack", jp: "－", sentence: "I am tired due to （a） _______ of sleep.", sentence_jp: "私は睡眠不足のため疲れている．（_______）" },
{ en: "extra", jp: "余分な", sentence: "an _______ charge.", sentence_jp: "追加料金（_______）" },
{ en: "ready", jp: "用意ができている", sentence: "I’m not _______ yet.", sentence_jp: "まだ準備ができていません．（_______）" },
{ en: "prepare", jp: "の準備をする", sentence: "_______ a meal.", sentence_jp: "食事_______" },
{ en: "adjust", jp: "慣れる", sentence: "_______ to a new school life.", sentence_jp: "新しい学校生活に_______" },
{ en: "apply", jp: "当てはまる", sentence: "_______ for a passport.", sentence_jp: "その規則は学生に適用される．（_______）" },
{ en: "suit", jp: "に適している", sentence: "file a _______ against her.", sentence_jp: "何時が（あなたに）ご都合がいいですか．（_______）" },
{ en: "case", jp: "場合", sentence: "This is the _______ with humans.", sentence_jp: "正直が割に合わない_______もある．" },
{ en: "scene", jp: "場面", sentence: "a love _______.", sentence_jp: "ラブシーン（_______）" },
{ en: "chance", jp: "機会", sentence: "a _______ to play the lead.", sentence_jp: "主役を演じる_______" },
{ en: "opportunity", jp: "機会", sentence: "have a golden _______ to speak English.", sentence_jp: "英語を話す絶好の_______を持つ" },
{ en: "experience", jp: "経験", sentence: "learn from _______.", sentence_jp: "_______から学ぶ" },
{ en: "time", jp: "時間", sentence: "If you have _______, help me.", sentence_jp: "_______があれば手伝ってよ．" },
{ en: "spring", jp: "春", sentence: "_______ has come.", sentence_jp: "_______が来た．" },
{ en: "minute", jp: "分", sentence: "The station is ten minutes’[a ten-_______] walk from here.", sentence_jp: "駅はここから歩いて10_______です．" },
{ en: "age", jp: "年齢", sentence: "a man past middle _______.", sentence_jp: "中年過ぎの男性（_______）" },
{ en: "generation", jp: "世代", sentence: "a _______ gap.", sentence_jp: "_______間格差" },
{ en: "anniversary", jp: "記念日", sentence: "celebrate our school’s 100th _______.", sentence_jp: "我が校の創立100周年を祝う（_______）" },
{ en: "recently", jp: "最近", sentence: "I moved to this city just _______.", sentence_jp: "_______この市に引っ越して来ました．" },
{ en: "used", jp: "以前は～だった", sentence: "I _______ to drive to work, but nowadays I take the train.", sentence_jp: "_______は車で仕事に行っていたが，今は電車を利用する．" },
{ en: "early", jp: "早く", sentence: "_______ in the morning.", sentence_jp: "朝_______に" },
{ en: "first", jp: "第1", sentence: "win _______ prize.", sentence_jp: "1等賞をとる（_______）" },
{ en: "latest", jp: "最新の", sentence: "follow the _______ fashions.", sentence_jp: "_______ファッションを追う" },
{ en: "modern", jp: "現代の", sentence: "in _______ society.", sentence_jp: "_______社会では" },
{ en: "ancient", jp: "古代の", sentence: "in _______ times.", sentence_jp: "大昔に（_______）" },
{ en: "spend", jp: "を費やす", sentence: "_______ most of my time reading[in my room, with my family].", sentence_jp: "時間の大半を読書に［部屋の中で，家族と一緒に］費やす［過ごす］（_______）" },
{ en: "delay", jp: "遅らせる", sentence: "without _______.", sentence_jp: "私たちが乗った列車が2時間遅れた．（_______）" },
{ en: "borrow", jp: "借りる", sentence: "_______ two books from the library.", sentence_jp: "図書館から2冊の本を_______" },
{ en: "lend", jp: "貸す", sentence: "Could you _______ me 10,000 yen?", sentence_jp: "1万円貸してもらえませんか．（_______）" },
{ en: "rent", jp: "借りる", sentence: "_______ a car for six hours.", sentence_jp: "6 時間，車を_______" },
{ en: "provide", jp: "を供給する", sentence: "_______ students with an opportunity to study in the U.K.", sentence_jp: "イギリス留学の機会を学生に与える（_______）" },
{ en: "board", jp: "板", sentence: "drill a hole through a _______.", sentence_jp: "_______にドリルで穴を開ける" },
{ en: "garbage", jp: "ごみ〈不可算〉", sentence: "plastic _______ bags.", sentence_jp: "ビニールの_______袋" },
{ en: "item", jp: "品物", sentence: "a news _______ about the village.", sentence_jp: "バーゲン品を買う（_______）" },
{ en: "wheel", jp: "車輪", sentence: "the front _______ of my bicycle.", sentence_jp: "自転車の前輪（_______）" },
{ en: "note", jp: "メモ", sentence: "a 50-pound _______.", sentence_jp: "授業中に_______をとる" },
{ en: "present", jp: "プレゼント", sentence: "open the _______.", sentence_jp: "_______を開ける" },
{ en: "bargain", jp: "買い得品〈可算〉", sentence: "find a good _______.", sentence_jp: "お_______得品を見つける" },
{ en: "stuff", jp: "もの", sentence: "lift heavy _______.", sentence_jp: "重い物を持ち上げる（_______）" },
{ en: "string", jp: "ひも", sentence: "tie up the box with some _______.", sentence_jp: "_______で箱を縛る" },
{ en: "leisure", jp: "余暇", sentence: "enjoy my _______ （time）.", sentence_jp: "_______を楽しむ" },
{ en: "diet", jp: "食事", sentence: "a well-balanced _______.", sentence_jp: "栄養バランスのとれた_______" },
{ en: "furniture", jp: "家具〈不可算〉", sentence: "a set of _______.", sentence_jp: "_______一式" },
{ en: "refrigerator", jp: "冷蔵庫", sentence: "put the leftovers in the _______.", sentence_jp: "_______に残り物を入れる" },
{ en: "traffic", jp: "交通〈不可算〉", sentence: "There is little _______ on the street today.", sentence_jp: "今日は，通りに車が少ない（_______量がほとんどない）．" },
{ en: "sell", jp: "売る", sentence: "Her books _______ very well.", sentence_jp: "私たちは車を50万円で売った．（_______）" },
{ en: "pay", jp: "を支払う", sentence: "_______ five dollars for the book.", sentence_jp: "その本の代金として5 ドルを払う（_______）" },
{ en: "wear", jp: "身につけている", sentence: "I _______ contact lenses.", sentence_jp: "コンタクトレンズをつけている．（_______）" },
{ en: "clothes", jp: "服〈複数扱い〉", sentence: "change my _______.", sentence_jp: "服を着替える（_______）" },
{ en: "marry", jp: "結婚する", sentence: "Will you _______ me?", sentence_jp: "（私と）_______してくれますか？" },
{ en: "greet", jp: "挨拶する", sentence: "_______ each other.", sentence_jp: "お互いに_______をする" },
{ en: "order", jp: "注文する", sentence: "_______ rice directly from the farm.", sentence_jp: "産地に直接米を_______" },
{ en: "room", jp: "部屋", sentence: "book a single _______ for two nights.", sentence_jp: "シングルルームを2泊予約する（_______）" },
{ en: "story", jp: "階", sentence: "a two-hundred-_______ skyscraper.", sentence_jp: "200_______建ての超高層ビル" },
{ en: "site", jp: "用地", sentence: "a dam _______ （＝a _______ for a dam）.", sentence_jp: "ダムの_______" },
{ en: "yard", jp: "庭", sentence: "mow the lawn in our _______.", sentence_jp: "私たちの_______の芝を刈る" },
{ en: "bottom", jp: "底", sentence: "the _______ of the sea.", sentence_jp: "海_______" },
{ en: "line", jp: "列", sentence: "stand in _______（〈英〉in a queue）.", sentence_jp: "_______に並ぶ" },
{ en: "row", jp: "列", sentence: "the people sitting in the back _______.", sentence_jp: "後_______に座っている人" },
{ en: "background", jp: "背景", sentence: "Classical music was playing in the _______.", sentence_jp: "BGM （_______）にクラシック音楽が流れていた．" },
{ en: "direction", jp: "方向", sentence: "go in[×to] the opposite _______.", sentence_jp: "反対の_______へ行く" },
{ en: "culture", jp: "文化", sentence: "a _______ of bacteria.", sentence_jp: "さまざまな外国_______" },
{ en: "art", jp: "芸術", sentence: "works of modern _______.", sentence_jp: "現代_______の作品" },
{ en: "cartoon", jp: "漫画", sentence: "Japanese animated cartoons.", sentence_jp: "日本のアニメーション作品（アニメ化された_______）" },
{ en: "novel", jp: "小説", sentence: "the plot of this _______.", sentence_jp: "この_______のあらすじ" },
{ en: "instrument", jp: "楽器", sentence: "play a musical _______.", sentence_jp: "_______を演奏する" },
{ en: "tune", jp: "曲", sentence: "That is a nice _______.", sentence_jp: "いい_______だね．" },
{ en: "sentence", jp: "文", sentence: "delete the _______.", sentence_jp: "その1_______を削除する" },
{ en: "article", jp: "記事", sentence: "a magazine _______ on Portugal.", sentence_jp: "ポルトガルに関する雑誌の_______" },
{ en: "passage", jp: "一節", sentence: "a famous _______ from the Bible.", sentence_jp: "聖書の有名な_______" },
{ en: "vocabulary", jp: "語彙", sentence: "increase[build up] my _______.", sentence_jp: "_______を増やす" },
{ en: "rumor", jp: "うわさ", sentence: "Rumors about him spread throughout the school.", sentence_jp: "彼の_______は学校中に広まった．" },
{ en: "spell", jp: "つづる", sentence: "How do you _______ your name?", sentence_jp: "名前はどのように_______りますか．" },
{ en: "pronounce", jp: "を発音する", sentence: "How do you _______ your name?", sentence_jp: "あなたの名前はどう発音するのですか．（_______）" },
{ en: "sign", jp: "兆候", sentence: "a _______ saying “No more Hiroshimas”.", sentence_jp: "回復の兆しが見られる（_______）" },
{ en: "mean", jp: "意味する", sentence: "What does that _______?", sentence_jp: "それはどういう_______ですか．" },
{ en: "publish", jp: "出版する", sentence: "This magazine is published twice a year.", sentence_jp: "この雑誌は年に2回発行されている．（_______）" },
{ en: "display", jp: "展示する", sentence: "_______ the latest fashions.", sentence_jp: "最新のファッションを_______" },
{ en: "trust", jp: "信頼する", sentence: "You can _______ him; he keeps secrets.", sentence_jp: "彼のことを_______してよい．彼は秘密を守る．" },
{ en: "depend", jp: "次第である", sentence: "I _______ on my parents for university tuition.", sentence_jp: "成功は君の努力（君がどれくらい努力するか）_______だ．" },
{ en: "rely", jp: "頼る", sentence: "You can _______ on him.", sentence_jp: "彼なら頼っても大丈夫．（_______）" },
{ en: "pray", jp: "祈る", sentence: "_______ for her safety.", sentence_jp: "彼女の無事を_______" },
{ en: "beg", jp: "嘆願する", sentence: "_______ her to overlook my mistakes.", sentence_jp: "ミスを見逃してもらうよう，彼女にお願いする（_______）" },
{ en: "prefer", jp: "を好む", sentence: "_______ beef to chicken.", sentence_jp: "鶏肉より牛肉_______" },
{ en: "weep", jp: "しくしく泣く", sentence: "All America wept.", sentence_jp: "全米が泣いた．（_______）" },
{ en: "hate", jp: "嫌う", sentence: "_______ doing housework.", sentence_jp: "家事をするのが嫌いだ（_______）" },
{ en: "worry", jp: "心配をする", sentence: "Don’t _______ about it.", sentence_jp: "そんなことを気にするな．（_______）" },
{ en: "anxious", jp: "心配して", sentence: "I’m _______ about her health.", sentence_jp: "彼女の健康が_______だ．" },
{ en: "satisfy", jp: "満足させる", sentence: "_______ the needs of tourists.", sentence_jp: "試験結果に_______していない．" },
{ en: "annoy", jp: "苛立たせる", sentence: "It really annoys me when I see people smoking while （they are） walking.", sentence_jp: "歩きタバコを見かけると頭にくる（歩きタバコは私を_______）．" },
{ en: "bother", jp: "面倒をかける", sentence: "I’m sorry to _______ you, but could you give me a hand?", sentence_jp: "ご迷惑をおかけしてすみませんが，手を貸していただけないでしょうか．（_______）" },
{ en: "disturb", jp: "迷惑をかける", sentence: "Don’t _______ other people.", sentence_jp: "ほかの人に_______をかけないようにしなさい．" },
{ en: "frighten", jp: "怯えさせる", sentence: "I am frightened of spiders.", sentence_jp: "クモがこわい（クモに_______させられる）．" },
{ en: "regret", jp: "後悔する", sentence: "I _______ that I did not study[×should have studied] hard in my teens.", sentence_jp: "10代のころ一生懸命勉強しなかったことを_______している．" },
{ en: "favor", jp: "親切な行為", sentence: "be in _______ of his proposal.", sentence_jp: "いくつかお願いがあるのですが．（_______）" },
{ en: "interest", jp: "関心", sentence: "have an _______ in history.", sentence_jp: "歴史に興味を持っている（_______）" },
{ en: "pity", jp: "残念なこと〈可算〉", sentence: "It is a _______ that you missed the movie.", sentence_jp: "あなたがその映画を見損ねたのは_______です．" },
{ en: "due", jp: "）が原因で", sentence: "Our flight was delayed _______ to the storm.", sentence_jp: "嵐のために飛行機が遅れた．（_______）" },
{ en: "reason", jp: "理由", sentence: "_______ and emotion.", sentence_jp: "次の_______で彼の意見に賛成だ" },
{ en: "result", jp: "結果", sentence: "as a _______ of inflation.", sentence_jp: "インフレの_______として" },
{ en: "effect", jp: "効果", sentence: "Drinking too much has a bad _______ on the brain.", sentence_jp: "過度の飲酒は脳に悪影響を与える．（_______）" },
{ en: "influence", jp: "影響", sentence: "have a strong _______ on them.", sentence_jp: "彼らに強い_______を与える" },
{ en: "end", jp: "結局～することになる", sentence: "at the _______ of May.", sentence_jp: "私たちは_______，空港で一夜を過ごすことになった．" },
{ en: "cause", jp: "引き起こす", sentence: "_______ trouble.", sentence_jp: "面倒を_______" },
{ en: "affect", jp: "影響を与える", sentence: "Lack of sleep seriously affects your performance at work.", sentence_jp: "睡眠不足は仕事（の出来栄え）に悪_______を及ぼす．" },
{ en: "way", jp: "方法", sentence: "my _______ of studying.", sentence_jp: "私の勉強の仕方（_______）" },
{ en: "manner", jp: "方法", sentence: "behave in a responsible _______.", sentence_jp: "責任ある_______でふるまう" },
{ en: "purpose", jp: "目的", sentence: "What is the _______ of your visit?", sentence_jp: "あなたの訪問の_______は何ですか．" },
{ en: "sake", jp: "ため", sentence: "for the _______ of your health.", sentence_jp: "健康の_______" },
{ en: "right", jp: "を修飾して）ちょうど", sentence: "_______ in front of me.", sentence_jp: "私のちょうど目の前で（_______）" },
{ en: "complete", jp: "完全な", sentence: "a _______ stranger.", sentence_jp: "見ず知らずの人（_______に知らない人）" },
{ en: "hardly", jp: "ほとんど～ない", sentence: "I can _______ wait for the summer.", sentence_jp: "夏が待ち遠しい（_______んど待てない）．" },
{ en: "almost", jp: "ほとんど", sentence: "I go to the gym _______ every day.", sentence_jp: "_______毎日ジムに通っている．" },
{ en: "partly", jp: "ある程度", sentence: "I am _______ to blame.", sentence_jp: "私にも一部責任が_______．" },
{ en: "indeed", jp: "実際に", sentence: "He is _______ a kind person.", sentence_jp: "彼は本当に親切な人です．（_______）" },
{ en: "even", jp: "さえも", sentence: "_______ Homer sometimes nods.", sentence_jp: "《ことわざ》弘法にも筆の誤り（ホメロスで_______時には居眠りする）．" },
{ en: "exactly", jp: "正確に", sentence: "Where _______ did you stay in Australia?", sentence_jp: "オーストラリアの_______はどこに滞在したのですか．" },
{ en: "gradually", jp: "徐々に", sentence: "Land prices are _______ increasing.", sentence_jp: "土地の値段が_______上がっている．" },
{ en: "therefore", jp: "それゆえに", sentence: "Even experts are only human, and _______ mistakes sometimes occur.", sentence_jp: "専門家でもただの人間だ．_______ゆえ，ミスが時々起きる．" },
{ en: "instead", jp: "代わりに", sentence: "If you can’t make it, your mother may go _______.", sentence_jp: "もし君が行けないのなら，君のお母さんが_______行ってもよい．" },
{ en: "until", jp: "まで", sentence: "We are open _______ 11 p.m. on weekdays.", sentence_jp: "平日は午後11時_______営業しています．" },
{ en: "besides", jp: "加えて", sentence: "learn another foreign language _______ English.", sentence_jp: "英語以外の（英語に_______）外国語を勉強する" },
{ en: "except", jp: "除いて", sentence: "Everybody was asleep _______ （for） him.", sentence_jp: "彼以外は皆眠っていた．（_______）" }
  ];

  const nameInput = document.getElementById("playerName");
  const firebaseStartBtn = document.getElementById("firebaseStartBtn"); // Firebase用のスタートボタン
  const hello = document.getElementById("hello");

  const quizScreen = document.getElementById('quiz-screen');
  const resultScreen = document.getElementById('result-screen');
  const scoreSpan = document.getElementById('score');
  const timerSpan = document.getElementById('timer');
  const questionWordDiv = document.getElementById('question-word');
  const sentenceDiv = document.getElementById('sentence');
  const hintTextDiv = document.getElementById('hint-text');
  const optionsContainer = document.getElementById('options-container');
  const hintButton = document.getElementById('hint-button');
  const nextButton = document.getElementById('next-button');
  const restartButton = document.getElementById('restart-button');
  const finalScoreDiv = document.getElementById('final-score');
  const answerMeaningDiv = document.getElementById('answer-meaning'); 

  // Firebaseランキング関連DOM
  const submitBtn = document.getElementById("submitBtn");
  const leaderboard = document.getElementById("leaderboard");
  const reloadBtn = document.getElementById("reloadBtn");
  const nameInputArea = document.getElementById("name-input-area"); // 名前入力エリア全体の要素

  let currentScore = 0; // クイズのスコア
  let timeLeft = 60;
  let timerInterval;
  let currentQuestion = null;
  let usedWords = [];
  let hintUsed = false;
  let questionActive = false; // 問題がアクティブかどうか

  // --- クイズのロジック ---
  function getRandomWords(count, excludeWord = null) {
      const availableForOptions = words.filter(word => word.en !== excludeWord);
      const shuffled = [...availableForOptions].sort(() => 0.5 - Math.random());
      return shuffled.slice(0, count);
  }

  function displayQuestion() {
      if (usedWords.length === words.length) {
          usedWords = [];
      }

      let availableWords = words.filter(word => !usedWords.includes(word.en));
      if (availableWords.length === 0) {
           availableWords = words;
           usedWords = [];
      }

      const randomIndex = Math.floor(Math.random() * availableWords.length);
      currentQuestion = availableWords[randomIndex];
      usedWords.push(currentQuestion.en);

      sentenceDiv.innerHTML = currentQuestion.sentence.replace(currentQuestion.en, '<span class="blank"></span>');
      hintTextDiv.textContent = '';
      answerMeaningDiv.textContent = ''; 

      hintUsed = false;
      hintButton.disabled = false;
      nextButton.disabled = true;

      const correctWord = currentQuestion.en;
      const options = getRandomWords(3, correctWord);
      options.push(currentQuestion);
      options.sort(() => Math.random() - 0.5);

      optionsContainer.innerHTML = '';
      options.forEach(option => {
          const button = document.createElement('button');
          button.classList.add('option-button');
          button.textContent = option.en;
          button.dataset.word = option.en;
          button.onclick = () => checkAnswer(button, option.en === correctWord);
          optionsContainer.appendChild(button);
      });
      questionActive = true;
      enableOptionButtons();
  }

  function disableOptionButtons() {
      const buttons = document.querySelectorAll('.option-button');
      buttons.forEach(button => {
          button.disabled = true;
      });
  }

  function enableOptionButtons() {
      const buttons = document.querySelectorAll('.option-button');
      buttons.forEach(button => {
          button.disabled = false;
      });
  }

  function checkAnswer(selectedButton, isCorrect) {
      if (!questionActive) return;

      disableOptionButtons();
      questionActive = false;
      hintButton.disabled = true;

      if (isCorrect) {
          selectedButton.classList.add('correct');
          currentScore += hintUsed ? 1 : 2;
      } else {
          selectedButton.classList.add('wrong');
          currentScore -= 2;
          const correctButton = Array.from(optionsContainer.children).find(btn => btn.dataset.word === currentQuestion.en);
          if (correctButton) {
              correctButton.classList.add('correct');
          }
      }
      const filledSentenceJp = currentQuestion.sentence_jp.replace('_______', `<strong>${currentQuestion.en}</strong>`);
      answerMeaningDiv.innerHTML = `<span class="meaning-line">意味: ${currentQuestion.jp}</span><span class="meaning-line">用例: ${filledSentenceJp}</span>`;
      
      scoreSpan.textContent = currentScore;
      nextButton.disabled = false;
  }

  function startTimer() {
      timeLeft = 60;
      timerSpan.textContent = timeLeft;
      clearInterval(timerInterval);
      timerInterval = setInterval(() => {
          timeLeft--;
          timerSpan.textContent = timeLeft;
          if (timeLeft <= 0) {
              clearInterval(timerInterval);
              endGame();
          }
      }, 1000);
  }

  function endGame() {
      quizScreen.style.display = 'none';
      resultScreen.style.display = 'block';
      finalScoreDiv.textContent = currentScore + '点';
      clearInterval(timerInterval);
      submitBtn.disabled = false; // スコア送信ボタンを有効にする
  }

  function resetGame() {
      currentScore = 0;
      scoreSpan.textContent = currentScore;
      timeLeft = 60;
      timerSpan.textContent = timeLeft;
      usedWords = [];
      hintUsed = false;
      questionActive = false;
      clearInterval(timerInterval);
      hintTextDiv.textContent = '';
      answerMeaningDiv.innerHTML = '';
      optionsContainer.innerHTML = '';
      submitBtn.disabled = true; // ゲームリセット時は送信ボタンを無効に
  }

  // --- イベントリスナーの修正・統合 ---
  firebaseStartBtn.addEventListener('click', () => {
      const name = (nameInput.value || "").trim();
      if (!name) { alert("名前を入れてな"); return; }
      hello.textContent = `がんばってな、${name}さん！`;
      
      nameInputArea.style.display = 'none'; // 名前入力エリアを非表示
      quizScreen.style.display = 'block'; // クイズ画面を表示

      resetGame();
      startTimer();
      displayQuestion();
  });

  nextButton.addEventListener('click', () => {
      if (timeLeft > 0) {
          displayQuestion();
      } else {
          endGame();
      }
  });

  hintButton.addEventListener('click', () => {
      if (currentQuestion && !hintUsed && questionActive) {
          const hintSentenceJp = currentQuestion.sentence_jp.replace('_______', '_______');
          hintTextDiv.innerHTML = `ヒント: ${currentQuestion.jp} (用例: ${hintSentenceJp})`;
          hintUsed = true;
          hintButton.disabled = true;
      }
  });

  restartButton.addEventListener('click', () => {
      resultScreen.style.display = 'none';
      nameInputArea.style.display = 'block'; // 名前入力エリアを再表示
      // クイズ開始は firebaseStartBtn から行うため、直接クイズ画面には行かない
      resetGame(); // ゲームの状態をリセット
      hello.textContent = ''; // がんばってなメッセージもリセット
  });

  // --- Firebaseランキング関連ロジック ---
  // スコア送信
  submitBtn.addEventListener("click", async () => {
    const name = (nameInput.value || "").trim() || "名無し";
    if (currentScore == null) { alert("スコアがありません。"); return; } // 安全策
    // Firestoreへ追加
    try {
      await addDoc(collection(db, "scores2"), {
        name,
        score: currentScore,
        createdAt: serverTimestamp()
      });
      submitBtn.disabled = true; // 送信後は再度送信できないようにする
      await loadTop5();
      alert("スコアを送信したで！ランキングに反映されたか見てみてな");
    } catch (error) {
      console.error("スコアの送信に失敗しました:", error);
      alert("スコアの送信に失敗しました。もう一度お試しください。");
    }
  });

  // 上位5を読み込んで表示
  async function loadTop5() {
    leaderboard.innerHTML = '<li>ランキング読み込み中...</li>'; // 読み込み中の表示
    try {
      const ref = collection(db, "scores2");
      const q = query(ref, orderBy("score", "desc"), orderBy("createdAt", "asc"), limit(5));
      const snap = await getDocs(q);
      const rows = snap.docs.map((d, i) => {
        const r = d.data();
        // createdAtはnullの場合があるので、その場合は適当な文字列にするか、フィルターする
        const timestamp = r.createdAt ? new Date(r.createdAt.seconds * 1000).toLocaleString('ja-JP') : '日付不明';
        return `<li>${i+1}. ${escapeHtml(r.name)} — ${r.score}点 (${timestamp})</li>`;
      });
      leaderboard.innerHTML = rows.length ? rows.join("") : "<li>まだ誰もいません</li>";
    } catch (error) {
      console.error("ランキングの読み込みに失敗しました:", error);
      leaderboard.innerHTML = '<li>ランキングの読み込みに失敗しました。</li>';
    }
  }

  reloadBtn.addEventListener("click", loadTop5);

  // かんたんエスケープ（XSS対策の最低限）
  function escapeHtml(s) {
    return String(s).replace(/[&<>"']/g, m => ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[m]));
  }

  // 初期表示設定
  nameInputArea.style.display = 'block';
  quizScreen.style.display = 'none';
  resultScreen.style.display = 'none';
  resetGame(); // 初回ロード時にゲーム状態を初期化
</script>
 </body>
</html>




